# ============================================================================
# ALEMBIC CONFIGURATION FILE
# ============================================================================
# Configuration untuk Alembic database migrations.
# 
# Alembic Commands:
#   alembic revision --autogenerate -m "message"  - Create new migration
#   alembic upgrade head                          - Apply all migrations
#   alembic downgrade -1                          - Rollback last migration
#   alembic current                               - Show current revision
#   alembic history                               - Show migration history
# ============================================================================

[alembic]
# ============================================================================
# PATH TO MIGRATION SCRIPTS
# ============================================================================
# Path ke folder yang berisi migration scripts
script_location = alembic

# ============================================================================
# TEMPLATE FOR GENERATING MIGRATION FILES
# ============================================================================
# Template untuk file migration baru
# file_template = %%(rev)s_%%(slug)s

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================
# sys.path path, will be prepended to sys.path if present.
# defaults to the current working directory.
prepend_sys_path = .

# ============================================================================
# TIMEZONE
# ============================================================================
# Timezone untuk timestamps dalam migrations
# timezone =

# ============================================================================
# MAX LENGTH OF CHARACTERS FOR AUTOGENERATE
# ============================================================================
# Max length of characters to apply to the "slug" field
# truncate_slug_length = 40

# ============================================================================
# SET TO 'true' TO RUN MIGRATIONS IN 'OFFLINE' MODE
# ============================================================================
# Set to 'true' to run migrations in 'offline' mode.
# This configures the context with just a URL
# and not an Engine, though an Engine is acceptable
# here as well. By skipping the Engine creation
# we don't even need a DBAPI to be available.
# 
# Calls to context.execute() here emit the given string to the
# script output.
# sqlalchemy.url = driver://user:pass@localhost/dbname

# ============================================================================
# DATABASE URL
# ============================================================================
# Database connection URL
# Format: postgresql://username:password@host:port/database
# 
# IMPORTANT: Jangan hardcode credentials di sini!
# Database URL akan di-set dari environment variables di alembic/env.py
# 
# Contoh (jangan gunakan ini):
# sqlalchemy.url = postgresql://postgres:password@localhost:5432/fastapi_db

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================
[loggers]
keys = root,sqlalchemy,alembic

[handlers]
keys = console

[formatters]
keys = generic

# ============================================================================
# ROOT LOGGER
# ============================================================================
[logger_root]
level = WARN
handlers = console
qualname =

# ============================================================================
# SQLALCHEMY LOGGER
# ============================================================================
# Set level to INFO untuk see SQL queries
# Set level to WARN untuk production
[logger_sqlalchemy]
level = WARN
handlers =
qualname = sqlalchemy.engine

# ============================================================================
# ALEMBIC LOGGER
# ============================================================================
[logger_alembic]
level = INFO
handlers =
qualname = alembic

# ============================================================================
# CONSOLE HANDLER
# ============================================================================
[handler_console]
class = StreamHandler
args = (sys.stderr,)
level = NOTSET
formatter = generic

# ============================================================================
# FORMATTER
# ============================================================================
[formatter_generic]
format = %(levelname)-5.5s [%(name)s] %(message)s
datefmt = %H:%M:%S

# ============================================================================
# USAGE NOTES
# ============================================================================
# 
# 1. SETUP ALEMBIC (first time only):
#    alembic init alembic
# 
# 2. CONFIGURE alembic/env.py:
#    - Import Base from app.db.base
#    - Set target_metadata = Base.metadata
#    - Get database URL from environment
# 
# 3. CREATE MIGRATION:
#    alembic revision --autogenerate -m "Add users table"
# 
# 4. REVIEW MIGRATION:
#    Check generated file in alembic/versions/
#    Make sure it's correct before applying
# 
# 5. APPLY MIGRATION:
#    alembic upgrade head
# 
# 6. ROLLBACK MIGRATION (if needed):
#    alembic downgrade -1
# 
# 7. CHECK STATUS:
#    alembic current
#    alembic history
# 
# PRODUCTION DEPLOYMENT:
# - Always review migrations before applying
# - Backup database before running migrations
# - Test migrations in staging first
# - Use "alembic upgrade head" in deployment script
# 
# COMMON ISSUES:
# 
# 1. "Target database is not up to date":
#    Solution: alembic stamp head
# 
# 2. "Can't locate revision identified by...":
#    Solution: Check alembic_version table in database
# 
# 3. "No such table: alembic_version":
#    Solution: alembic upgrade head (creates table)
# 
# ============================================================================